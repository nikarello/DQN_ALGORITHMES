# DQN_ALGORITHMES
–°—Ä–∞–≤–Ω–µ–Ω–∏–µ Dueling DDQN, QRDQN, Prioritized –∏ Noisy DQN –Ω–∞ –∑–∞–¥–∞—á–µ —ç–≤–∞–∫—É–∞—Ü–∏–∏ –∞–≥–µ–Ω—Ç–æ–≤

# üöí –ú–Ω–æ–≥–æ–∞–≥–µ–Ω—Ç–Ω–∞—è –≠–≤–∞–∫—É–∞—Ü–∏—è —Å Deep Q-Learning

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –º–æ–¥–µ–ª–∏—Ä—É–µ—Ç —ç–≤–∞–∫—É–∞—Ü–∏—é –∞–≥–µ–Ω—Ç–æ–≤ –∏–∑ –∑–¥–∞–Ω–∏—è —Å –ø–æ–∂–∞—Ä–∞–º–∏, –∏—Å–ø–æ–ª—å–∑—É—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è —Å –ø–æ–¥–∫—Ä–µ–ø–ª–µ–Ω–∏–µ–º (RL). –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã:

- ‚úÖ Dueling Double DQN
- ‚úÖ QR-DQN (Quantile Regression DQN)
- ‚úÖ Dueling Double DQN —Å Prioritized Experience Replay (PER)
- ‚úÖ Noisy Dueling Double DQN

---

## üì¶ –°–æ—Å—Ç–∞–≤ –ø—Ä–æ–µ–∫—Ç–∞

```bash
full_jaga_jaga/
‚îú‚îÄ‚îÄ main.py                    # –û—Å–Ω–æ–≤–Ω–æ–π –∑–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è
‚îú‚îÄ‚îÄ run_all.py                # –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤
‚îú‚îÄ‚îÄ config.json               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è run_all.py)
‚îú‚îÄ‚îÄ config_test_*.json        # –¢–µ—Å—Ç–æ–≤—ã–µ –∫–æ–Ω—Ñ–∏–≥–∏ –¥–ª—è –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∑–∞–ø—É—Å–∫–æ–≤
‚îú‚îÄ‚îÄ algorithms/
‚îÇ   ‚îú‚îÄ‚îÄ base_trainer.py       # –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –æ–±—É—á–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ dueling_ddqn.py       # –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π Dueling DDQN
‚îÇ   ‚îú‚îÄ‚îÄ qr_dqn.py             # –ö–≤–∞–Ω—Ç–∏–ª—å–Ω—ã–π QR-DQN
‚îÇ   ‚îú‚îÄ‚îÄ dueling_ddqn_prioritized.py  # Dueling DDQN + Prioritized Replay
‚îÇ   ‚îî‚îÄ‚îÄ noisy_dueling_ddqn.py        # Noisy-Net Dueling DDQN
‚îú‚îÄ‚îÄ core.py                   # –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Å—Ä–µ–¥—ã, –¥–≤–∏–∂–µ–Ω–∏—è, —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–π
‚îú‚îÄ‚îÄ environment.py            # –ö–ª–∞—Å—Å Environment
‚îú‚îÄ‚îÄ videos/                   # –°—é–¥–∞ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤–∏–¥–µ–æ —ç–ø–∏–∑–æ–¥–æ–≤
‚îú‚îÄ‚îÄ metrics_*.csv             # –ú–µ—Ç—Ä–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è –ø–æ –∫–∞–∂–¥–æ–º—É –∞–ª–≥–æ—Ä–∏—Ç–º—É
‚îî‚îÄ‚îÄ video_*.mp4               # –í–∏–¥–µ–æ —Ñ–∏–Ω–∞–ª—å–Ω—ã—Ö —ç–ø–∏–∑–æ–¥–æ–≤
```
üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

pip install torch numpy matplotlib imageio pandas
üî• –î–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤–∏–¥–µ–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è ffmpeg (–æ–±—ã—á–Ω–æ –ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤–º–µ—Å—Ç–µ —Å imageio)

‚öôÔ∏è –ó–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è
üß† 1. –û–¥–∏–Ω –∞–ª–≥–æ—Ä–∏—Ç–º
–î–ª—è –∑–∞–ø—É—Å–∫–∞ –æ–¥–Ω–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —Å –∑–∞–¥–∞–Ω–Ω—ã–º –∫–æ–Ω—Ñ–∏–≥–æ–º:


python main.py --config config_test_ddqn.json
–ü—Ä–∏–º–µ—Ä—ã –∫–æ–Ω—Ñ–∏–≥–æ–≤:

config_test_ddqn.json ‚Äî Dueling DDQN

config_test_qr.json ‚Äî QR-DQN

config_test_ddqn_prioritized.json ‚Äî Prioritized Dueling DDQN

config_test_noisy.json ‚Äî Noisy Dueling DDQN

üîÑ 2. –í—Å–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –ø–æ –æ—á–µ—Ä–µ–¥–∏
–°–∫—Ä–∏–ø—Ç run_all.py –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç –≤—Å–µ 4 –∞–ª–≥–æ—Ä–∏—Ç–º–∞:

python run_all.py
–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –≤:

metrics_DuelingDDQN.csv, metrics_QRDQN.csv, ...

video_DuelingDDQN.mp4, video_QRDQN.mp4, ...

üìä –ú–µ—Ç—Ä–∏–∫–∏
–í–æ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –º–µ—Ç—Ä–∏–∫–∏ –≤ CSV –∏ —Å—Ç—Ä–æ—è—Ç—Å—è –≥—Ä–∞—Ñ–∏–∫–∏:

Reward ‚Äî –°—É–º–º–∞—Ä–Ω–∞—è –Ω–∞–≥—Ä–∞–¥–∞ —ç–ø–∏–∑–æ–¥–∞

Evacuated / Died ‚Äî –ß–∏—Å–ª–æ —ç–≤–∞–∫—É–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∏ –ø–æ–≥–∏–±—à–∏—Ö

Avg steps to exit ‚Äî –°—Ä–µ–¥–Ω–µ–µ —á–∏—Å–ª–æ —à–∞–≥–æ–≤ –¥–æ –≤—ã—Ö–æ–¥–∞

Avg HP at exit ‚Äî –°—Ä–µ–¥–Ω–µ–µ –∑–¥–æ—Ä–æ–≤—å–µ —É —Å–ø–∞—Å—ë–Ω–Ω—ã—Ö

Epsilon ‚Äî –ó–Ω–∞—á–µ–Ω–∏–µ Œµ –≤ Œµ-greedy —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏

Loss ‚Äî –°—Ä–µ–¥–Ω–∏–π loss –ø–æ —ç–ø–∏–∑–æ–¥—É

–ü—Ä–∏–º–µ—Ä –≥—Ä–∞—Ñ–∏–∫–∞:


Saved to ‚Üí metrics_<algorithm>.csv
Saved to ‚Üí video_<algorithm>.mp4
üé• –í–∏–¥–µ–æ—ç–ø–∏–∑–æ–¥—ã
–ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –≤–∏–¥–µ–æ (.mp4) —Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π 4 —Ä–∞–∑–Ω—ã—Ö —Å—Ä–µ–¥ (–µ—Å–ª–∏ –µ—Å—Ç—å).

–ê–≥–µ–Ω—Ç—ã ‚Äî —Å–∏–Ω–∏–µ

–û–≥–æ–Ω—å ‚Äî –∫—Ä–∞—Å–Ω—ã–π

–í—ã—Ö–æ–¥ ‚Äî –∑–µ–ª—ë–Ω—ã–π

–ü—Ä–∏–º–µ—Ä—ã:

video_DuelingDDQN.mp4

video_QRDQN.mp4

üìå –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ config.json

ALGORITHM	–ù–∞–∑–≤–∞–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ (—Å–º. —Å–ø–∏—Å–æ–∫ –≤—ã—à–µ)
NUM_EPISODES	–ß–∏—Å–ª–æ —ç–ø–∏–∑–æ–¥–æ–≤
NUM_ENVS	–°–∫–æ–ª—å–∫–æ —Å—Ä–µ–¥ —Ç—Ä–µ–Ω–∏—Ä—É—é—Ç—Å—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
BATCH_SIZE	–†–∞–∑–º–µ—Ä –±–∞—Ç—á–∞
LEARNING_RATE	–°–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è
MEMORY_SIZE	–†–∞–∑–º–µ—Ä replay buffer
AGENT_SPECS	–§–æ—Ä–º–∞—Ç: [[–∫–æ–ª-–≤–æ, —Ä–∞–∑–º–µ—Ä], ...] ‚Äî —Ä–∞–∑–º–µ—Ä—ã –∞–≥–µ–Ω—Ç–æ–≤
METRICS_CSV	–ü—É—Ç—å –∫ —Ñ–∞–π–ª—É –º–µ—Ç—Ä–∏–∫
VIDEO_PATH	–ü—É—Ç—å –∫ –≤–∏–¥–µ–æ—Ñ–∞–π–ª—É
